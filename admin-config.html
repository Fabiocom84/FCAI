<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuratore Logica - Segretario AI</title>
    <link rel="stylesheet" href="style-v2.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css"/>
    <style>
        .admin-container { max-width: 1200px; margin: 30px auto; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .tabs { display: flex; border-bottom: 2px solid #eee; margin-bottom: 20px; }
        .tab { padding: 15px 25px; cursor: pointer; font-weight: bold; color: #666; }
        .tab.active { color: #3498db; border-bottom: 3px solid #3498db; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        .data-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        .data-table th, .data-table td { padding: 12px; border-bottom: 1px solid #eee; text-align: left; }
        .data-table th { background: #f8f9fa; }
        .data-table td { overflow: visible; }
        
        .edit-row { background-color: #f0f7ff; }
        .action-btn { padding: 5px 10px; background: #3498db; color: white; border-radius: 4px; cursor: pointer; border: none; }
        .save-btn { background: #2ecc71; }
        
        /* Stile Choices compatto per la tabella */
        .choices__inner { min-height: 35px; padding: 2px 5px; }
        .choices__list--dropdown { z-index: 100 !important; /* Forza il menu sopra tutto */ }
    </style>
</head>
<body>
    <div class="page-wrapper">
        <header class="page-header">
            <a href="index.html" class="header-button">Indietro</a>
            <h1>Configuratore Logica</h1>
        </header>

        <div class="admin-container">
            <div class="tabs">
                <div class="tab active" data-target="tab-macros">1. Macro Categorie</div>
                <div class="tab" data-target="tab-components">2. Configura Componenti</div>
                <div class="tab" data-target="tab-orders">3. Configura Commesse</div>
            </div>

            <!-- TAB 1: MACRO CATEGORIE -->
            <div id="tab-macros" class="tab-content active">
                <h3>Gestione Macro Categorie (Tag)</h3>
                <div style="margin-bottom: 15px; display: flex; gap: 10px;">
                    <input type="text" id="newMacroName" placeholder="Nome Macro (es. Elettrico)" style="padding: 10px;">
                    <input type="text" id="newMacroIcon" placeholder="Icona (es. âš¡)" style="width: 80px; padding: 10px;">
                    <button id="addMacroBtn" class="button button--primary">Aggiungi</button>
                </div>
                <table class="data-table" id="macrosTable">
                    <thead><tr><th>ID</th><th>Nome</th><th>Icona</th><th>Azioni</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>

            <!-- TAB 2: COMPONENTI (Aggiornato) -->
            <div id="tab-components" class="tab-content">
                <h3>Gestione Componenti & Associazioni</h3>
                
                <!-- BARRA INSERIMENTO NUOVO -->
                <div style="background: #f1f8ff; padding: 15px; border-radius: 6px; margin-bottom: 20px; display: flex; gap: 10px; align-items: center; border: 1px solid #cce5ff;">
                    <strong>Nuovo:</strong>
                    <input type="text" id="newCompName" placeholder="Nome Componente (es. Albero Motore)" style="flex-grow: 1; padding: 10px;">
                    <input type="text" id="newCompCode" placeholder="Codice (opz.)" style="width: 150px; padding: 10px;">
                    <button id="addCompBtn" class="button button--primary" style="white-space: nowrap;">+ Aggiungi Componente</button>
                </div>

                <!-- Controlli Paginazione -->
                <div class="pagination-controls" style="margin: 10px 0; display: flex; justify-content: space-between; align-items: center;">
                    <button id="prevCompPage" class="action-btn">Precedente</button>
                    <span id="compPageIndicator" style="font-weight: bold;">Pagina 1</span>
                    <button id="nextCompPage" class="action-btn">Successiva</button>
                </div>

                <table class="data-table" id="componentsTable">
                    <thead>
                        <tr>
                            <th width="25%">Nome & Codice</th>
                            <th width="20%">Macro Categoria</th>
                            <th width="20%">Ruoli Abilitati</th>
                            <th width="20%">Fasi Abilitate</th>
                            <th width="15%">Azioni</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <!-- TAB 3: COMMESSE -->
            <div id="tab-orders" class="tab-content">
                <h3>Attiva Macro Categorie su Commesse</h3>
                <table class="data-table" id="ordersTable">
                    <thead>
                        <tr>
                            <th width="30%">Commessa</th>
                            <th width="60%">Macro Categorie Attive</th>
                            <th width="10%">Salva</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
    <script type="module" src="js/config.js"></script>
    <script type="module" src="js/api-client.js"></script>
    <script type="module" src="js/admin-config.js"></script>
</body>
</html>