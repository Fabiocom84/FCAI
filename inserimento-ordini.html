<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inserimento Ordini - Segretario AI</title>
    
    <!-- Stili -->
    <link rel="stylesheet" href="style-v2.css"> <!-- Base -->
    <link rel="stylesheet" href="inserimento-ore.css"> <!-- Per Header/Generali -->
    <link rel="stylesheet" href="inserimento-ordini.css"> <!-- Specifico -->
    
    <!-- PDF.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>
</head>
<body>

    <div class="page-wrapper">
        
        <!-- HEADER (Stile App Mobile) -->
        <header class="mobile-nav-header">
            <a href="index.html" class="header-button">
                <img src="img/log-out.png" alt="Back" style="width: 16px; height: 16px; filter: brightness(0) invert(1); transform: rotate(180deg);">
                <span>Home</span>
            </a>
            <div class="title-container">
                <h1>Importazione Ordini</h1>
                <span class="header-username">Produzione</span>
            </div>
            <!-- Placeholder per bilanciare layout flex -->
            <div style="width: 70px;"></div> 
        </header>

        <!-- ZONA 1: CARICAMENTO (Sempre Visibile) -->
        <div id="drop-zone" class="drop-zone-card">
            <div class="drop-content">
                <img src="img/production-order.png" alt="Upload">
                <h3 id="drop-title">Trascina qui il PDF</h3>
                <p id="drop-subtitle">oppure clicca per selezionare</p>
                
                <button class="file-select-btn" onclick="document.getElementById('fileInput').click()">Sfoglia File</button>
                <input type="file" id="fileInput" multiple accept=".pdf" hidden>
            </div>
            <div id="upload-spinner" class="spinner" style="display: none; margin-top:15px;"></div>
        </div>

        <!-- ZONA 2: TABELLA DATI (Sempre Visibile) -->
        <div class="table-card">
            <div class="table-header-row">
                <h2>Dati Rilevati</h2>
                <button id="addManualRowBtn" class="add-row-btn">
                    <span>+</span> Aggiungi Riga
                </button>
            </div>

            <div class="table-responsive">
                <table class="preview-table">
                    <thead>
                        <tr>
                            <th style="width: 50px;">Stato</th>
                            <th style="width: 100px;">OP</th>
                            <th style="width: 250px;">Commessa</th>
                            <th style="width: 100px;">Codice</th>
                            <th>Descrizione</th>
                            <th style="width: 70px;">Q.t√†</th>
                            <th style="width: 150px;">Reparto</th>
                            <th style="width: 50px;"></th>
                        </tr>
                    </thead>
                    <tbody id="preview-body">
                        <!-- Default state -->
                        <tr class="empty-state-row">
                            <td colspan="8">Nessun dato caricato. Trascina un file o aggiungi una riga manuale.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

    </div>

    <!-- FOOTER FISSO -->
    <div class="sticky-footer">
        <button id="clearBtn" class="cancel-button">Pulisci</button>
        <button id="confirmBtn" class="save-button">Salva Ordini</button>
    </div>

    <!-- MODALI -->
    <div id="modalOverlay" class="modal-overlay" style="display: none;"></div>
    <div id="success-feedback-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="feedback-modal-title"></h2>
                <button class="close-button" onclick="closeSuccessFeedbackModal()">&times;</button>
            </div>
            <div class="modal-body feedback-body">
                <h3 id="feedback-modal-message"></h3>
            </div>
            <div class="modal-footer">
                <button onclick="closeSuccessFeedbackModal()" class="save-button" style="width: auto; padding: 10px 30px; margin: 0 auto;">OK</button>
            </div>
        </div>
    </div>
    
    <!-- Script Moduli -->
    <script type="module" src="js/config.js"></script>
    <script type="module" src="js/auth-guard.js"></script>
    <script type="module" src="js/api-client.js"></script>
    <script type="module" src="js/shared-ui.js"></script>
    <script type="module" src="js/inserimento-ordini.js"></script>

</body>
</html>